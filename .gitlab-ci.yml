stages:
  - test

phpunit:
  stage: test
  image: dh-iutl.univ-artois.fr/composer
  tags:
    - docker
  script:
    - cp .env.example .env
    - composer install --no-interaction --prefer-dist --optimize-autoloader
    - php artisan key:generate
    - echo "Lancement des tests PHPUnit..."
    - php artisan test
  only:
    - merge_requests
    - main
    - dev
